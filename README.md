# Ph.D. Project: Sialic Acid Cross-feeding

**Title:** Investigation of the cross-feeding mechanism of sialic acids between *Staphylococcus aureus* and commensal bacteria in the context of atopic dermatitis.

![Bioinformatic Pipeline Step](./images/image.png)
*(Figure: Workflow of the bioinformatic analysis)*

---

## FLASH Tools Configuration

To calculate the parameters `-m` (minimum) and `-M` (maximum), use the following formula:

> **Overlap = (2 Ã— Reads) - Fragment**

### How to obtain the values:

1.  **Read Length:** Use the `zcat` command to inspect the raw file:
    ```bash
    zcat /home/marcos/PRJEB59406/fastq_files/ERR10856949_1.fastq.gz | head -n 2 | tail -n 1 | wc -c
    ```

2.  **Fragment Size:** * Open the **HTML report** generated by `fastp`.
    * Look for the **Insert Size Estimation** graph.
    * Use the value indicated at the **Peak**.

## Execution Order
graph TD
    %% Node Styles (Colors to differentiate file types)
    classDef shell fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef python fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;
    classDef ipynb fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;
    classDef start fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,stroke-dasharray: 5 5;

    %% Start Node
    Input(Raw FASTQ Data):::start --> Clean1

    %% Group 2: Cleaning and Assembly
    subgraph Cleaning ["2. Cleaning & Assembly"]
        direction TB
        Clean1[fastp.sh]:::shell --> Clean2[align_reads_human_genome_Bowtie2.sh]:::shell
        Clean2 --> Clean3[Remove_human_genome_Bowtie2.sh]:::shell
        Clean3 --> Clean4[flash.sh]:::shell
        Clean4 --> Clean5[megahit.sh]:::shell
    end

    %% Connection between groups
    Clean5 --> Func1

    %% Group 3: Functional Analysis
    subgraph Functional ["3. Functional Analysis"]
        direction TB
        Func1[prodigal_script.sh]:::shell --> Func2[script_diamond.sh]:::shell
        Func2 --> Func3[filtering_diamond.sh]:::shell
        Func3 --> Func4[extract_filtered_fna.py]:::python
        Func4 --> Func5[indexing_fna.sh]:::shell
        Func5 --> Func6[allign_fna_bowtie2.sh]:::shell
        Func6 --> Func7[Joinning_idxst.py]:::python
    end

    %% Connection between groups
    Func7 --> Stat1
    Func7 --> Stat2

    %% Group 4: Statistical Analysis
    subgraph Stats ["4. Statistical Analysis"]
        direction TB
        Stat1(plots.ipynb):::ipynb
        Stat2(plots_taxonomy.ipynb):::ipynb
    end

### 1. Preparation
*(Initial data setup)*

### 2. Cleaning and Assembly
The pipeline follows this specific sequence:
1.  `fastp.sh` (Quality Control)
2.  `align_reads_human_genome_Bowtie2.sh` (Host Alignment)
3.  `Remove_human_genome_Bowtie2.sh` (Decontamination)
4.  `flash.sh` (Merge Paired-end Reads)
5.  `megahit.sh` (Assembly)

### 3. Functional Analysis
1.  `prodigal_script.sh` (Gene Prediction)
2.  `script_diamond.sh` (Protein Alignment)
3.  `filtering_diamond.sh` (Quality Filtering)
4.  `extract_filtered_fna.py` (Sequence Extraction)
5.  `indexing_fna.sh` (Index Building)
6.  `allign_fna_bowtie2.sh` (Alignment)
7.  `Joinning_idxst.py` (Statistical Merging)

### 4. Statistical Analysis
1. `plots.ipynb`
2. `plots_taxonomy.ipynb`

